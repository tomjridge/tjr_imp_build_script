<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tjr_fs_shared_doc (tjr_fs_shared.Tjr_fs_shared.Tjr_fs_shared_doc)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">tjr_fs_shared</a> &#x00BB; <a href="../index.html">Tjr_fs_shared</a> &#x00BB; Tjr_fs_shared_doc</nav><h1>Module <code>Tjr_fs_shared.Tjr_fs_shared_doc</code></h1></header><aside><p>A summary of the main types provided by this package.</p></aside><section><header><h2 id="types"><a href="#types" class="anchor"></a>Types</h2></header><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include </span><a href="../index.html#module-Blk_dev_ops_type">Blk_dev_ops_type</a></code></span></summary><aside></aside><div class="spec module" id="module-Generic_over_dev"><a href="#module-Generic_over_dev" class="anchor"></a><code><span class="keyword">module </span>Generic_over_dev = <a href="../Blk_dev_ops_type/index.html#module-Generic_over_dev">Blk_dev_ops_type.Generic_over_dev</a></code></div><dl><dt class="spec type" id="type-blk_dev_ops"><a href="#type-blk_dev_ops" class="anchor"></a><code><span class="keyword">type </span>('blk_id, 'blk, 't) blk_dev_ops</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-blk_dev_ops.blk_sz" class="anchored"><td class="def field"><a href="#type-blk_dev_ops.blk_sz" class="anchor"></a><code>blk_sz : <a href="../Blk_sz_type/index.html#type-blk_sz">Blk_sz_type.blk_sz</a>;</code></td></tr><tr id="type-blk_dev_ops.write" class="anchored"><td class="def field"><a href="#type-blk_dev_ops.write" class="anchor"></a><code>write : blk_id:<span class="type-var">'blk_id</span> <span>&#45;&gt;</span> blk:<span class="type-var">'blk</span> <span>&#45;&gt;</span> (unit, <span class="type-var">'t</span>) <a href="../../../tjr_monad/Tjr_monad/Monad_ops/index.html#type-m">Tjr_monad.Monad_ops.m</a>;</code></td></tr><tr id="type-blk_dev_ops.read" class="anchored"><td class="def field"><a href="#type-blk_dev_ops.read" class="anchor"></a><code>read : blk_id:<span class="type-var">'blk_id</span> <span>&#45;&gt;</span> (<span class="type-var">'blk</span>, <span class="type-var">'t</span>) <a href="../../../tjr_monad/Tjr_monad/Monad_ops/index.html#type-m">Tjr_monad.Monad_ops.m</a>;</code></td></tr></table><code>}</code></dt><dd><p>The following variant has a fixed block device.</p></dd></dl></details></div></div></div><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include </span><a href="../index.html#module-Blk_sz_type">Blk_sz_type</a></code></span></summary><aside></aside><dl><dt class="spec type" id="type-blk_sz"><a href="#type-blk_sz" class="anchor"></a><code><span class="keyword">type </span>blk_sz</code><code><span class="keyword"> = </span>int</code></dt></dl></details></div></div></div><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include </span><a href="../index.html#module-Block_ops_type">Block_ops_type</a></code></span></summary><aside></aside><aside><p>Operations on blocks</p></aside><dl><dt class="spec type" id="type-block_ops"><a href="#type-block_ops" class="anchor"></a><code><span class="keyword">type </span>'blk block_ops</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-block_ops.blk_sz" class="anchored"><td class="def field"><a href="#type-block_ops.blk_sz" class="anchor"></a><code>blk_sz : <a href="../Blk_sz_type/index.html#type-blk_sz">Blk_sz_type.blk_sz</a>;</code></td></tr><tr id="type-block_ops.of_string" class="anchored"><td class="def field"><a href="#type-block_ops.of_string" class="anchor"></a><code>of_string : string <span>&#45;&gt;</span> <span class="type-var">'blk</span>;</code></td></tr><tr id="type-block_ops.to_string" class="anchored"><td class="def field"><a href="#type-block_ops.to_string" class="anchor"></a><code>to_string : <span class="type-var">'blk</span> <span>&#45;&gt;</span> string;</code></td></tr><tr id="type-block_ops.of_bytes" class="anchored"><td class="def field"><a href="#type-block_ops.of_bytes" class="anchor"></a><code>of_bytes : bytes <span>&#45;&gt;</span> <span class="type-var">'blk</span>;</code></td></tr><tr id="type-block_ops.to_bytes" class="anchored"><td class="def field"><a href="#type-block_ops.to_bytes" class="anchor"></a><code>to_bytes : <span class="type-var">'blk</span> <span>&#45;&gt;</span> bytes;</code></td></tr></table><code>}</code></dt><dd><p>NOTE since blk_sz is expected to be fixed for a given blk type, we don't include as a parameter on the main interface methods</p><p>FIXME get_blk_sz should be just blk_sz?</p></dd></dl></details></div></div></div><dl><dt class="spec type" id="type-op"><a href="#type-op" class="anchor"></a><code><span class="keyword">type </span>('k, 'v) op</code><code><span class="keyword"> = </span>(<span class="type-var">'k</span>, <span class="type-var">'v</span>) <a href="../Kv_op_type/index.html#type-op">Kv_op_type.op</a></code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-op.Insert" class="anchored"><td class="def constructor"><a href="#type-op.Insert" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Insert</span><span class="keyword"> of </span><span class="type-var">'k</span><span class="keyword"> * </span><span class="type-var">'v</span></code></td></tr><tr id="type-op.Delete" class="anchored"><td class="def constructor"><a href="#type-op.Delete" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Delete</span><span class="keyword"> of </span><span class="type-var">'k</span></code></td></tr></table></dt></dl><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include </span><a href="../index.html#module-Map_ops_type">Map_ops_type</a></code></span></summary><aside></aside><dl><dt class="spec type" id="type-map_ops"><a href="#type-map_ops" class="anchor"></a><code><span class="keyword">type </span>('k, 'v, 't) map_ops</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-map_ops.find" class="anchored"><td class="def field"><a href="#type-map_ops.find" class="anchor"></a><code>find : <span class="type-var">'k</span> <span>&#45;&gt;</span> (<span class="type-var">'v</span> option, <span class="type-var">'t</span>) <a href="../../../tjr_monad/Tjr_monad/Types/index.html#type-m">Tjr_monad.Types.m</a>;</code></td></tr><tr id="type-map_ops.insert" class="anchored"><td class="def field"><a href="#type-map_ops.insert" class="anchor"></a><code>insert : <span class="type-var">'k</span> <span>&#45;&gt;</span> <span class="type-var">'v</span> <span>&#45;&gt;</span> (unit, <span class="type-var">'t</span>) <a href="../../../tjr_monad/Tjr_monad/Types/index.html#type-m">Tjr_monad.Types.m</a>;</code></td></tr><tr id="type-map_ops.delete" class="anchored"><td class="def field"><a href="#type-map_ops.delete" class="anchor"></a><code>delete : <span class="type-var">'k</span> <span>&#45;&gt;</span> (unit, <span class="type-var">'t</span>) <a href="../../../tjr_monad/Tjr_monad/Types/index.html#type-m">Tjr_monad.Types.m</a>;</code></td></tr><tr id="type-map_ops.insert_many" class="anchored"><td class="def field"><a href="#type-map_ops.insert_many" class="anchor"></a><code>insert_many : <span class="type-var">'k</span> <span>&#45;&gt;</span> <span class="type-var">'v</span> <span>&#45;&gt;</span> (<span class="type-var">'k</span><span class="keyword"> * </span><span class="type-var">'v</span>) list <span>&#45;&gt;</span> ((<span class="type-var">'k</span><span class="keyword"> * </span><span class="type-var">'v</span>) list, <span class="type-var">'t</span>) <a href="../../../tjr_monad/Tjr_monad/Types/index.html#type-m">Tjr_monad.Types.m</a>;</code></td></tr></table><code>}</code></dt><dd><p>Map operations: find, insert, <code>insert_many</code> and delete.</p><p><code>insert_many</code> attempts to insert as many as possible in a single operation, and returns the remainder, and so is typically called in a loop (see <a href="../Map_ops/index.html"><code>Map_ops</code></a>).</p><p>The interfaces are heavily parameterized. To understand the interfaces, we need to introduce the following:</p><ul><li>Keys, represented by type variable <code>'k</code></li><li>Values, by type var <code>'v</code></li><li>Page/block references, <code>'r</code>; vars <code>blk_id</code></li><li>Phantom monad type, <code>'t</code></li></ul><p>The operations execute in the monad.</p></dd></dl></details></div></div></div><dl><dt class="spec type" id="type-ss"><a href="#type-ss" class="anchor"></a><code><span class="keyword">type </span>ss</code><code><span class="keyword"> = </span><a href="../Small_string/index.html#type-ss">Small_string.ss</a></code></dt></dl></section><section><header><h2 id="implementations"><a href="#implementations" class="anchor"></a>Implementations</h2></header><aside><p>Note the following implementations:</p><ul><li><a href="../Blk_dev_in_mem/index.html"><code>Blk_dev_in_mem</code></a>, <a href="../Blk_dev_on_fd/index.html"><code>Blk_dev_on_fd</code></a>, <a href="../Block_ops/String_block_ops/index.html"><code>Block_ops.String_block_ops</code></a></li><li><a href="../Kv_op/index.html#val-default_kvop_map_ops"><code>Kv_op.default_kvop_map_ops</code></a></li></ul></aside></section></div></body></html>