<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Synchronous_store (tjr_kv.Tjr_kv.Synchronous_store)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../index.html">tjr_kv</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Tjr_kv.Synchronous_store</span></h1></header><p>An uncached kv store</p><p>NOTE see diagram in &lt;root&gt;/docs/</p><p>At a high level, this is a k -&gt; v map.</p><p>This is uncached: there is no cache in front of the store. The pcache
works on a raw uncached block device. The B-tree syncs the block
device after every batch operation.</p><p>We expect to use this with an LRU in front.</p><p>At intervals, when the pcache becomes long, some initial prefix of the
pcache is rolled into the B-tree. The root of the pcache is adjusted
(the old blocks can be reclaimed), and the root is written to disk
(but not necessarily synced). On crash, if the old root is used there
is no problem - we just replay these modifications over the B-tree. We
require that if the new pcache root hits disk, the B-tree is also on
disk. One approach is to async (flush btree; flush pcache root).</p><div class="spec module-type" id="module-type-REQUIRES"><a href="#module-type-REQUIRES" class="anchor"></a><div class="def module-type"><code><span class="keyword">module type </span><a href="module-type-REQUIRES/index.html">REQUIRES</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec module" id="module-Make"><a href="#module-Make" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Make/index.html">Make</a> : <span class="keyword">functor</span> (<a href="Make/argument-1-Requires/index.html">Requires</a> : <a href="index.html#module-type-REQUIRES">REQUIRES</a>) -&gt; <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div></body></html>